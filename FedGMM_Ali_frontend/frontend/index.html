<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>城市旅游消费个性化推荐系统</title>
    <!-- 引入CSS样式 -->
    <link rel="stylesheet" href="css/style.css">
    <!-- 引入Chart.js库 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 引入主JavaScript文件 -->
    <script src="js/main.js"></script>
    <!-- 引入反馈系统JavaScript文件 -->
    <script src="js/feedback.js"></script>
</head>
<body>
    <!-- 头部 -->
    <header class="header">
        <div class="container">
            <h1>城市旅游消费个性化推荐系统</h1>
        </div>
    </header>

    <!-- 导航菜单 -->
    <nav class="nav">
        <div class="container">
            <ul>
                <li><a href="index.html">首页</a></li>
                <li><a href="pages/communication/index.html">通信压缩分析</a></li>
                <li><a href="pages/adaptive/index.html">自适应迭代分析</a></li>
                <li><a href="pages/personalization/index.html">个性化权重分析</a></li>
                <li><a href="pages/recommendation/index.html">推荐展示</a></li>
                <li><a href="pages/comparison/index.html">综合对比</a></li>
                <li><a href="pages/training/index.html">训练参数输入</a></li>
            </ul>
        </div>
    </nav>

    <!-- 主内容区 -->
    <main class="container">
        <!-- 系统介绍 -->
        <section class="card">
            <h2>系统介绍</h2>
            <p>本系统基于联邦学习和混合模型技术，实现了城市旅游消费的个性化推荐。系统分为两条主线：训练过程展示和用户推荐使用，旨在展示通信开销低、个性化推荐更精准、自适应本地迭代等创新点。</p>
            <p>系统支持查看通信压缩效果、自适应迭代轨迹、个性化权重分布等训练过程数据，同时提供基于已训练模型的城市旅游消费推荐功能。</p>
        </section>

        <!-- 快速入口 -->
        <section class="quick-access">
            <div class="quick-access-item">
                <h3>训练过程展示</h3>
                <p>查看通信压缩效果、自适应迭代轨迹、个性化权重分布等训练过程数据</p>
                <a href="pages/communication/index.html" class="btn btn-primary">进入</a>
            </div>
            <div class="quick-access-item">
                <h3>用户推荐使用</h3>
                <p>基于已训练模型，获取不同城市的个性化旅游消费推荐</p>
                <a href="pages/recommendation/index.html" class="btn btn-primary">进入</a>
            </div>
        </section>

        <!-- 系统状态 -->
        <section class="system-status">
            <h3>系统状态</h3>
            <div class="system-status-item">
                <span class="label">连接状态</span>
                <span class="value connection-status" id="connection-status"></span>
            </div>
            <div class="system-status-item">
                <span class="label">数据加载状态</span>
                <span class="value" id="data-loaded">检查中...</span>
            </div>
            <div class="system-status-item">
                <span class="label">可用城市</span>
                <span class="value" id="available-cities">检查中...</span>
            </div>
            <div class="system-status-item">
                <span class="label">可用训练轮次</span>
                <span class="value" id="available-rounds">检查中...</span>
            </div>
            <div class="system-status-item">
                <span class="label">系统状态</span>
                <span class="value" id="system-status">初始化中...</span>
            </div>
        </section>

        <!-- 论文章节对应 -->
        <section class="card">
            <h2>论文章节对应</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>章节</th>
                        <th>创新点概要</th>
                        <th>在系统中的体现方式</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>第三章</td>
                        <td>基于混合模型的重要度自适应压缩的个性化联邦学习</td>
                        <td>① 通信开销低（Top-k + 残差反馈）<br>② 个性化（多子模型 + 客户端混合权重 γ）</td>
                    </tr>
                    <tr>
                        <td>第四章</td>
                        <td>基于自适应本地迭代的差分隐私机制</td>
                        <td>① 聚合时本地迭代次数 τ* 动态变化<br>② 可选：隐私预算/效用权衡等</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- 快速开始说明 -->
        <section class="card">
            <h2>快速开始</h2>
            <h3>训练过程展示</h3>
            <ol>
                <li>点击导航菜单中的"通信压缩分析"、"自适应迭代分析"或"个性化权重分析"</li>
                <li>选择相应的参数（如客户端、轮次范围等）</li>
                <li>查看分析结果和图表</li>
                <li>可选择导出数据为CSV格式</li>
            </ol>
            
            <h3>用户推荐使用</h3>
            <ol>
                <li>点击导航菜单中的"推荐展示"</li>
                <li>选择城市、输入用户ID、设置Top-K和训练轮次</li>
                <li>点击"生成推荐"按钮</li>
                <li>查看推荐结果和多城市对比</li>
                <li>可选择导出推荐结果为CSV格式</li>
            </ol>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 城市旅游消费个性化推荐系统</p>
        </div>
    </footer>

    <!-- 页面脚本 -->
    <script>
        // 页面加载完成后初始化
        window.addEventListener('DOMContentLoaded', async () => {
            // 获取系统状态
            await updateSystemStatus();
        });
        
        // 更新系统状态
        async function updateSystemStatus() {
            try {
                // 显示加载状态
                document.getElementById('data-loaded').textContent = '检查中...';
                document.getElementById('available-cities').textContent = '检查中...';
                document.getElementById('available-rounds').textContent = '检查中...';
                document.getElementById('system-status').textContent = '初始化中...';
                
                // 获取系统状态
                const status = await Utils.getSystemStatus();
                
                // 更新状态信息
                document.getElementById('data-loaded').textContent = status.data_loaded ? '已加载' : '未加载';
                document.getElementById('available-cities').textContent = status.available_cities.length > 0 ? status.available_cities.join(', ') : '无可用城市';
                document.getElementById('available-rounds').textContent = status.available_rounds.length > 0 ? status.available_rounds.join(', ') : '无可用轮次';
                document.getElementById('system-status').textContent = status.system_status;
                
                // 如果数据未加载，显示警告信息
                if (!status.data_loaded) {
                    const mainContainer = document.querySelector('main.container');
                    const warningElement = document.createElement('div');
                    warningElement.className = 'warning';
                    warningElement.textContent = '数据文件未找到，请检查 data/ 目录';
                    mainContainer.insertBefore(warningElement, mainContainer.firstChild);
                }
            } catch (error) {
                console.error('更新系统状态失败:', error);
                document.getElementById('system-status').textContent = '系统状态获取失败';
            }
        }
    </script>
</body>
</html>
